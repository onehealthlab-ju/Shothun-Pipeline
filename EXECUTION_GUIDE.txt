================================================================================
SHOTGUN METAGENOMICS PIPELINE - EXECUTION GUIDE
================================================================================

ğŸ“¦ PACKAGE CONTENTS (8 files)
================================================================================

1. environment.yml                      Conda environment definition
2. setup_pipeline.sh                    Database setup script
3. test_pipeline.sh                     Test/verification script  
4. run_metagenomics_pipeline.sh        Main pipeline (single sample)
5. run_batch_samples.sh                Batch processing script
6. samples_list_template.txt           Template for batch input
7. README_QUICKSTART.md                Detailed documentation
8. PIPELINE_OVERVIEW.md                This overview guide

Total: ~2,600 lines of production-ready code

================================================================================
ğŸš€ EXECUTION WORKFLOW
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          FIRST TIME SETUP                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 1: Setup Environment (ONE TIME ONLY)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  bash setup_pipeline.sh                  â”‚  â±ï¸  2-6 hours
â”‚                                          â”‚  ğŸ’¾  50-150 GB
â”‚  â†’ Creates conda environment             â”‚
â”‚  â†’ Downloads databases (interactive)     â”‚
â”‚  â†’ Verifies installations                â”‚
â”‚  â†’ Creates config file                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
Step 2: Test Installation (RECOMMENDED)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  bash test_pipeline.sh                   â”‚  â±ï¸  5-10 minutes
â”‚                                          â”‚  ğŸ’¾  <1 GB
â”‚  â†’ Downloads test data                   â”‚
â”‚  â†’ Runs core pipeline steps              â”‚
â”‚  â†’ Validates outputs                     â”‚
â”‚  â†’ Generates test report                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
        âœ… READY TO USE!

================================================================================
ğŸ“Š RUNNING THE PIPELINE
================================================================================

Option A: SINGLE SAMPLE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚  1. Prepare Data                                                            â”‚
â”‚     mkdir -p rawdata                                                        â”‚
â”‚     # Copy your files: sample01_R1.fastq.gz, sample01_R2.fastq.gz          â”‚
â”‚                                                                             â”‚
â”‚  2. Configure Pipeline                                                      â”‚
â”‚     nano run_metagenomics_pipeline.sh                                       â”‚
â”‚     # Edit lines 20-50:                                                     â”‚
â”‚     #   - SAMPLE_ID                                                         â”‚
â”‚     #   - Database paths                                                    â”‚
â”‚     #   - THREADS, MEMORY                                                   â”‚
â”‚                                                                             â”‚
â”‚  3. Activate Environment                                                    â”‚
â”‚     conda activate shotgun-metagenomics-pipeline                            â”‚
â”‚                                                                             â”‚
â”‚  4. Run Pipeline                                                            â”‚
â”‚     bash run_metagenomics_pipeline.sh                                       â”‚
â”‚     â±ï¸  6-12 hours (depends on data size and resources)                     â”‚
â”‚                                                                             â”‚
â”‚  5. View Results                                                            â”‚
â”‚     firefox results/visualization/sample01_multiqc_report.html              â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Option B: BATCH PROCESSING (Multiple Samples)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚  1. Create Sample List                                                      â”‚
â”‚     cp samples_list_template.txt my_samples.txt                             â”‚
â”‚     nano my_samples.txt                                                     â”‚
â”‚     # Add samples (tab-separated):                                          â”‚
â”‚     # sample01<TAB>rawdata/s01_R1.fq.gz<TAB>rawdata/s01_R2.fq.gz           â”‚
â”‚     # sample02<TAB>rawdata/s02_R1.fq.gz<TAB>rawdata/s02_R2.fq.gz           â”‚
â”‚                                                                             â”‚
â”‚  2. Configure Batch Script                                                  â”‚
â”‚     nano run_batch_samples.sh                                               â”‚
â”‚     # Edit database paths (lines 40-50)                                     â”‚
â”‚                                                                             â”‚
â”‚  3. Run Batch Processing                                                    â”‚
â”‚     bash run_batch_samples.sh my_samples.txt                                â”‚
â”‚     â±ï¸  N Ã— (6-12 hours) where N = number of samples                        â”‚
â”‚                                                                             â”‚
â”‚  4. View Batch Summary                                                      â”‚
â”‚     cat batch_results_*/batch_summary.txt                                   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
ğŸ“ OUTPUT STRUCTURE
================================================================================

results/
â”œâ”€â”€ qc/                              FastQC reports
â”œâ”€â”€ preprocessing/                   Clean, filtered reads
â”œâ”€â”€ taxonomic_profiling/             Species abundances
â”‚   â”œâ”€â”€ *.kraken2.report            Kraken2 taxonomy
â”‚   â”œâ”€â”€ *.bracken.species           Refined abundances  
â”‚   â””â”€â”€ *.metaphlan.profile.txt     MetaPhlAn profile
â”œâ”€â”€ functional_profiling/            Metabolic pathways
â”‚   â”œâ”€â”€ *_genefamilies_relab.tsv    Gene families
â”‚   â””â”€â”€ *_pathabundance_relab.tsv   Pathway abundances
â”œâ”€â”€ assembly/                        Assembled contigs
â”‚   â”œâ”€â”€ *_contigs.fa                Final assembly
â”‚   â””â”€â”€ *_quast/                    Quality metrics
â”œâ”€â”€ binning/                         Genome bins (MAGs)
â”‚   â”œâ”€â”€ *_bin.*.fa                  Individual bins
â”‚   â””â”€â”€ *_checkm_results.txt        Quality assessment
â”œâ”€â”€ annotation/                      Gene predictions
â”‚   â”œâ”€â”€ *_proteins.faa              Protein sequences
â”‚   â””â”€â”€ *_eggnog.emapper.*          Functional annotations
â”œâ”€â”€ visualization/                   Reports and charts
â”‚   â”œâ”€â”€ *_multiqc_report.html      â­ START HERE!
â”‚   â””â”€â”€ *_krona.html                Interactive taxonomy
â””â”€â”€ *_pipeline_summary.txt          Overall summary

================================================================================
âš™ï¸  SYSTEM REQUIREMENTS
================================================================================

MINIMUM                              RECOMMENDED
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
CPU:     8 cores                    CPU:     16-32 cores
RAM:     32 GB                      RAM:     64-128 GB
Storage: 100 GB                     Storage: 500 GB (SSD)
Runtime: 12-24 hours/sample         Runtime: 3-6 hours/sample

================================================================================
ğŸ” PIPELINE STEPS BREAKDOWN
================================================================================

 Step â”‚ Tool(s)              â”‚ Purpose                        â”‚ Time (16 cores)
â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1   â”‚ FastQC               â”‚ Quality control                â”‚   5-10 min
  2   â”‚ fastp                â”‚ Trim & filter reads            â”‚  10-15 min
  3   â”‚ Bowtie2              â”‚ Remove host DNA                â”‚  15-30 min
  4   â”‚ Kraken2 + Bracken    â”‚ Taxonomic classification       â”‚  20-40 min
  5   â”‚ MetaPhlAn            â”‚ Marker-based profiling         â”‚  30-60 min
  6   â”‚ HUMAnN3              â”‚ Functional profiling           â”‚   1-2 hours
  7   â”‚ MEGAHIT              â”‚ Assemble metagenome            â”‚   2-4 hours
  8   â”‚ QUAST                â”‚ Assembly QC                    â”‚   5-10 min
  9   â”‚ Bowtie2 + samtools   â”‚ Map reads to contigs           â”‚  30-60 min
 10   â”‚ MetaBAT2 + MaxBin2   â”‚ Bin contigs into MAGs          â”‚   1-2 hours
 11   â”‚ CheckM               â”‚ Assess MAG quality             â”‚   1-2 hours
 12   â”‚ Prodigal             â”‚ Predict genes                  â”‚  10-30 min
 13   â”‚ eggNOG-mapper        â”‚ Annotate gene functions        â”‚   1-2 hours
 14   â”‚ Krona                â”‚ Taxonomic visualization        â”‚   2-5 min
 15   â”‚ MultiQC              â”‚ Aggregate QC reports           â”‚   2-5 min
â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                                                    TOTAL: ~6-12 hours/sample

================================================================================
ğŸ’¡ TIPS FOR SUCCESS
================================================================================

âœ… DO:
  â€¢ Run test_pipeline.sh before processing real data
  â€¢ Start with Kraken2 Standard database (smaller, faster)
  â€¢ Check MultiQC report first for quality overview
  â€¢ Keep raw data backed up separately
  â€¢ Use SSD for better I/O performance
  â€¢ Process samples in batches for efficiency

âŒ DON'T:
  â€¢ Run multiple samples simultaneously (unless you have resources)
  â€¢ Skip quality control steps
  â€¢ Delete intermediate files until analysis complete
  â€¢ Ignore failed QC metrics
  â€¢ Use insufficient memory (causes crashes)

================================================================================
ğŸ› QUICK TROUBLESHOOTING
================================================================================

Problem: Command not found
Solution: conda activate shotgun-metagenomics-pipeline

Problem: Out of memory
Solution: Reduce THREADS or increase RAM allocation

Problem: Database not found  
Solution: Check paths in configuration match setup_pipeline.sh output

Problem: Slow performance
Solution: Increase THREADS, use SSD, or use smaller databases

Problem: Pipeline stops
Solution: Check log file: cat results/pipeline_*.log | grep -i error

================================================================================
ğŸ“Š INTERPRETING RESULTS
================================================================================

KEY FILES TO CHECK:

1ï¸âƒ£  results/visualization/sample_multiqc_report.html
    â†³ Overall QC summary - CHECK THIS FIRST!
    â†³ Read quality, preprocessing stats, assembly metrics

2ï¸âƒ£  results/taxonomic_profiling/sample.kraken2.report
    â†³ Which species are present?
    â†³ What are their relative abundances?

3ï¸âƒ£  results/functional_profiling/sample_pathabundance_relab.tsv
    â†³ Which metabolic pathways are active?
    â†³ What functions are enriched?

4ï¸âƒ£  results/binning/sample_checkm_results.txt
    â†³ How many high-quality MAGs recovered?
    â†³ Completeness and contamination scores

5ï¸âƒ£  results/visualization/sample_krona.html
    â†³ Interactive taxonomic tree
    â†³ Visual exploration of community composition

================================================================================
ğŸ“š ADDITIONAL RESOURCES
================================================================================

Documentation:     README_QUICKSTART.md (detailed usage guide)
Overview:          PIPELINE_OVERVIEW.md (this file)
Sample List:       samples_list_template.txt
Log Files:         results/pipeline_*.log
Configuration:     pipeline_config.txt (created by setup script)

Tool Manuals:
  FastQC:          fastqc --help
  Kraken2:         kraken2 --help
  MetaPhlAn:       metaphlan --help
  HUMAnN:          humann --help
  MEGAHIT:         megahit --help
  CheckM:          checkm -h

================================================================================
âœ… PRE-FLIGHT CHECKLIST
================================================================================

Before running the pipeline, verify:

â–¡ Conda environment created and activated
â–¡ At least one database downloaded (Kraken2 minimum)
â–¡ Test pipeline passed successfully
â–¡ Input FASTQ files exist and are valid
â–¡ Configuration edited with correct paths
â–¡ Sufficient disk space available (>100 GB free)
â–¡ Sufficient RAM available (>32 GB)
â–¡ No other resource-intensive processes running

================================================================================
ğŸ¯ QUICK START COMMANDS
================================================================================

# Complete workflow from scratch:

# 1. First time setup (once)
bash setup_pipeline.sh

# 2. Test installation (once)  
bash test_pipeline.sh

# 3. Process single sample
conda activate shotgun-metagenomics-pipeline
bash run_metagenomics_pipeline.sh

# 4. OR process multiple samples
bash run_batch_samples.sh my_samples.txt

# 5. View results
firefox results/visualization/*_multiqc_report.html

================================================================================
ğŸ‰ YOU'RE READY TO GO!
================================================================================

This pipeline provides a complete, production-ready workflow for shotgun
metagenomics analysis. All major analysis steps are automated with robust
error handling and comprehensive reporting.

For detailed information, see README_QUICKSTART.md

Good luck with your metagenomics research! ğŸ§¬

================================================================================
